CREATE TABLE Order (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    customer_id NUMBER NOT NULL,
    order_date TIMESTAMP WITH TIME ZONE DEFAULT SYSTIMESTAMP,
    status VARCHAR2(20) DEFAULT 'PENDING'
);

CREATE TABLE OrderLine (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    order_id NUMBER REFERENCES "Order"(id) ON DELETE CASCADE,
    product_id NUMBER NOT NULL,
    quantity NUMBER DEFAULT 1 CHECK (quantity > 0),
    unit_price DECIMAL(10, 2),
    total_price DECIMAL(10, 2) GENERATED ALWAYS AS (quantity * unit_price) VIRTUAL
);

CREATE TABLE Invoice (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    order_id NUMBER REFERENCES "Order"(id) ON DELETE CASCADE,
    invoice_date TIMESTAMP WITH TIME ZONE DEFAULT SYSTIMESTAMP
);
